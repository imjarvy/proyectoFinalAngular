<div class="max-w-2xl mx-auto p-4">
  <div class="cart-card">
  <div class="cart-header">
    <h2 class="text-2xl font-bold text-slate-900">Carrito</h2>
    <span class="cart-sub">Revisa tus artículos antes de pagar</span>
  </div>
  <table class="cart-table mb-4">
    <thead>
      <tr>
        <th class="px-4 py-2 border-b">Producto</th>
        <th class="px-4 py-2 border-b">Cantidad</th>
        <th class="px-4 py-2 border-b">Precio</th>
        <th class="px-4 py-2 border-b">Total</th>
        <th class="px-4 py-2 border-b">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <ng-container *ngIf="cartItems.length === 0; else cartContent">
        <tr>
          <td colspan="5" class="text-center py-4">El carrito está vacío</td>
        </tr>
      </ng-container>
      <ng-template #cartContent>
        <tr *ngFor="let item of cartItems">
          <td class="cell-strong">{{ item.name }}</td>
          <td>
            <input
              type="number"
              min="1"
              [value]="item.quantity"
              (input)="handleQuantityChange(item.id, $event.target.value)"
              class="qty-input"
            />
          </td>
          <td class="cell-right">{{ item.price }}</td>
          <td class="cell-right">{{ item.price * item.quantity }}</td>
          <td class="cell-center">
            <button
              class="btn-danger"
              (click)="handleRemove(item.id)"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </ng-template>
    </tbody>
  </table>

  <form (submit)="handleSubmit($event)" class="space-y-4 mt-8">
    <select name="address" [value]="form.address" (change)="handleApartmentSelect($event)" required class="field w-full">
      <option value="">Selecciona Apartamento</option>
      <option *ngFor="let a of addresses" [value]="a | json">{{ a.street }} {{ a.city ? '- ' + a.city : '' }}</option>
    </select>
    <input type="hidden" name="menu_id" [value]="form.menu_id" />
    <select name="motorcycle_id" [value]="form.motorcycle_id" (change)="handleFormChange($event)" required class="field w-full">
      <option value="">Selecciona Moto (solo disponibles)</option>
      <option *ngFor="let m of motorcycles" [value]="m.id">{{ m.license_plate }}</option>
    </select>
    <div class="w-full">
      <label class="block text-sm font-semibold mb-1 text-slate-600">Precio Total</label>
      <input
        name="total_price"
        [value]="total"
        readonly
        type="number"
        class="field w-full bg-gray-100 text-gray-700"
      />
    </div>
    <input type="hidden" name="status" value="pending" />
    <input type="hidden" name="created_at" [value]="form.created_at" />
    <input type="hidden" name="customer_id" [value]="form.customer_id" />
    <div class="flex gap-3">
      <button type="submit" class="btn-primary">Guardar</button>
      <button type="button" class="btn-secondary" (click)="handleRemove('')">Vaciar</button>
    </div>
  </form>
  </div>
</div>
<div class="ms-auth-page">
  <section class="ms-auth-card">
    <header class="ms-auth-header">
      <h3 class="ms-auth-title">
        {{ isAuthenticated() ? '¬°Bienvenido!' : 'Iniciar Sesi√≥n' }}
      </h3>
      <p class="ms-auth-subtitle">
        Inicia sesi√≥n con tu cuenta de Microsoft para acceder a todas las funcionalidades de la aplicaci√≥n.
      </p>
    </header>

    <main class="ms-auth-content" *ngIf="!isAuthenticated(); else authenticatedBlock">
      <app-microsoft-login-button></app-microsoft-login-button>

      <section class="ms-auth-info">
        <h4>Informaci√≥n</h4>
        <ul>
          <li>Utiliza tu cuenta corporativa o personal de Microsoft</li>
          <li>La autenticaci√≥n es segura mediante OAuth 2.0</li>
          <li>Solo solicitamos permisos b√°sicos de lectura de perfil</li>
        </ul>
      </section>
    </main>

    <ng-template #authenticatedBlock>
      <div class="ms-auth-success">
        ‚úì Autenticado exitosamente como <strong>{{ firstAccountName() }}</strong>
      </div>
    </ng-template>
  </section>

  <section *ngIf="isAuthenticated()" class="ms-auth-profile">
    <app-microsoft-user-profile></app-microsoft-user-profile>
  </section>

  <section class="ms-auth-tech">
    <h3>Informaci√≥n T√©cnica</h3>
    <div class="ms-auth-tech-grid">
      <div>
        <span class="label">Estado de autenticaci√≥n</span>
        <p>{{ isAuthenticated() ? 'üü¢ Autenticado' : 'üî¥ No autenticado' }}</p>
      </div>

      <div>
        <span class="label">N√∫mero de cuentas activas</span>
        <p>{{ accountsCount() }}</p>
      </div>

      <ng-container *ngIf="accountsCount() > 0">
        <div>
          <span class="label">Tipo de cuenta</span>
          <p>{{ accountType() }}</p>
        </div>

        <div>
          <span class="label">Username</span>
          <p class="break">{{ firstAccountUsername() }}</p>
        </div>
      </ng-container>
    </div>
  </section>
</div>
